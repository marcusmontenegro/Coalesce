steps:
  STG_ORDERS_LINEITEM-c5c5283b-7fd6-4bfe-8fad-1733ff926271:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: WORK
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: 8c6340de-f7f7-43c6-864f-e62e21a99eda
              stepCounter: c5c5283b-7fd6-4bfe-8fad-1733ff926271
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d2c3175b-5a35-4656-8061-18ba13658f2d
                    stepCounter: 252c6629-cc41-424d-b143-6fd2d53d8237
                transform: ""
          - columnReference:
              columnCounter: aa745572-ac95-4333-b827-6319e1ca8d14
              stepCounter: c5c5283b-7fd6-4bfe-8fad-1733ff926271
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CUSTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 1f57f55e-0138-4e9d-8a4b-83b1d5f9849b
                    stepCounter: 252c6629-cc41-424d-b143-6fd2d53d8237
                transform: ""
          - columnReference:
              columnCounter: 5957f623-551e-483f-9ea3-3226a2571da0
              stepCounter: c5c5283b-7fd6-4bfe-8fad-1733ff926271
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERSTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2f5510a3-5400-432c-a95f-9985d26ba50b
                    stepCounter: 252c6629-cc41-424d-b143-6fd2d53d8237
                transform: ""
          - columnReference:
              columnCounter: ea11b0dc-4ecb-4975-99aa-6e6d9789c069
              stepCounter: c5c5283b-7fd6-4bfe-8fad-1733ff926271
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_TOTALPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e6a490de-1b2f-4151-902a-5e81951da19f
                    stepCounter: 252c6629-cc41-424d-b143-6fd2d53d8237
                transform: ""
          - columnReference:
              columnCounter: 4e3b4d54-b48a-41cf-8bea-d41fc69f3c51
              stepCounter: c5c5283b-7fd6-4bfe-8fad-1733ff926271
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 35ab2ae3-884e-458b-9b9b-4710ac43e51b
                    stepCounter: 252c6629-cc41-424d-b143-6fd2d53d8237
                transform: ""
          - columnReference:
              columnCounter: 0b1a1943-aed1-4f7a-9170-96e7289df4a8
              stepCounter: c5c5283b-7fd6-4bfe-8fad-1733ff926271
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ae148cb2-ee8d-4159-8de8-e0cb1b566127
                    stepCounter: 252c6629-cc41-424d-b143-6fd2d53d8237
                transform: ""
          - columnReference:
              columnCounter: 2dd18429-ccd2-41a5-9f88-2a847daed608
              stepCounter: c5c5283b-7fd6-4bfe-8fad-1733ff926271
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY_DESC
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ae148cb2-ee8d-4159-8de8-e0cb1b566127
                    stepCounter: 252c6629-cc41-424d-b143-6fd2d53d8237
                transform: SPLIT_PART("STG_ORDERS"."O_ORDERPRIORITY",'-',12)
          - columnReference:
              columnCounter: 0f07eece-5c54-4878-bee5-7559aee74913
              stepCounter: c5c5283b-7fd6-4bfe-8fad-1733ff926271
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY_NUM
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ae148cb2-ee8d-4159-8de8-e0cb1b566127
                    stepCounter: 252c6629-cc41-424d-b143-6fd2d53d8237
                transform: SPLIT_PART("STG_ORDERS"."O_ORDERPRIORITY",'-',1)
          - columnReference:
              columnCounter: f93540ec-a1ed-4019-b4da-9ee226b6e003
              stepCounter: c5c5283b-7fd6-4bfe-8fad-1733ff926271
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CLERK
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 659ec42b-c23e-4ccc-97c6-54b9ecda011f
                    stepCounter: 252c6629-cc41-424d-b143-6fd2d53d8237
                transform: ""
          - columnReference:
              columnCounter: 3d11c37e-d1ee-4d76-b562-5265a54a8d23
              stepCounter: c5c5283b-7fd6-4bfe-8fad-1733ff926271
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_SHIPPRIORITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e67129b3-1d72-4cbc-9917-3f242f0509ad
                    stepCounter: 252c6629-cc41-424d-b143-6fd2d53d8237
                transform: ""
          - columnReference:
              columnCounter: 55746a35-99ae-4cf8-a2d3-bbc087ee8e30
              stepCounter: c5c5283b-7fd6-4bfe-8fad-1733ff926271
            dataType: VARCHAR(79)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f17b2573-87f5-451a-81a6-9b0bd5641999
                    stepCounter: 252c6629-cc41-424d-b143-6fd2d53d8237
                transform: ""
          - columnReference:
              columnCounter: c6ae4310-a435-4cb9-805c-91fd9a04c730
              stepCounter: c5c5283b-7fd6-4bfe-8fad-1733ff926271
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 64e16fca-f99b-4d9c-970c-e2466d53b934
                    stepCounter: 7f3daf64-f84d-4f3f-a86a-19c60b15fffc
                transform: ""
          - columnReference:
              columnCounter: 27ee457d-e9e3-4a0c-a9a4-6efef50bfbe2
              stepCounter: c5c5283b-7fd6-4bfe-8fad-1733ff926271
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_PARTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a0915799-62db-448c-a88b-7840a656cb60
                    stepCounter: 7f3daf64-f84d-4f3f-a86a-19c60b15fffc
                transform: ""
          - columnReference:
              columnCounter: 83513911-fdd7-462e-b982-f724e3319ddb
              stepCounter: c5c5283b-7fd6-4bfe-8fad-1733ff926271
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SUPPKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: bf13ab95-c403-4a0a-a675-bbbd97f91109
                    stepCounter: 7f3daf64-f84d-4f3f-a86a-19c60b15fffc
                transform: ""
          - columnReference:
              columnCounter: d3352993-39e3-469d-aafb-8d0de23804fa
              stepCounter: c5c5283b-7fd6-4bfe-8fad-1733ff926271
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINENUMBER
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 0d9dd231-40f5-47a5-ab12-bebd8370a359
                    stepCounter: 7f3daf64-f84d-4f3f-a86a-19c60b15fffc
                transform: ""
          - columnReference:
              columnCounter: 87e57821-44a6-494e-98d6-643789275bce
              stepCounter: c5c5283b-7fd6-4bfe-8fad-1733ff926271
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_QUANTITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 07f06e60-25d6-42bb-baef-30cdd3708b4f
                    stepCounter: 7f3daf64-f84d-4f3f-a86a-19c60b15fffc
                transform: ""
          - columnReference:
              columnCounter: db514af9-b65d-4f7e-806b-003f39c3816d
              stepCounter: c5c5283b-7fd6-4bfe-8fad-1733ff926271
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_EXTENDEDPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 7666575b-cc90-4ae9-bda6-823cd25943e2
                    stepCounter: 7f3daf64-f84d-4f3f-a86a-19c60b15fffc
                transform: ""
          - columnReference:
              columnCounter: d28f9940-bfb3-4a8e-a5ff-8d5e9eb6cd3b
              stepCounter: c5c5283b-7fd6-4bfe-8fad-1733ff926271
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_DISCOUNT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 73ebe5af-8abd-4ad5-bb7e-824b681a35b4
                    stepCounter: 7f3daf64-f84d-4f3f-a86a-19c60b15fffc
                transform: ""
          - columnReference:
              columnCounter: 335c1616-4972-4999-8d02-bbbe0516990a
              stepCounter: c5c5283b-7fd6-4bfe-8fad-1733ff926271
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_TAX
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: bf1a4084-625b-4f09-a510-140997f182bd
                    stepCounter: 7f3daf64-f84d-4f3f-a86a-19c60b15fffc
                transform: ""
          - columnReference:
              columnCounter: 9adba0b9-c4d4-4fb6-9b56-52cdf745d0a8
              stepCounter: c5c5283b-7fd6-4bfe-8fad-1733ff926271
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RETURNFLAG
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ac996d18-97f1-43d1-b56e-a92e4ae1ff79
                    stepCounter: 7f3daf64-f84d-4f3f-a86a-19c60b15fffc
                transform: ""
          - columnReference:
              columnCounter: df1a4a88-8d02-4966-8a59-d81c2dfee186
              stepCounter: c5c5283b-7fd6-4bfe-8fad-1733ff926271
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINESTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4b359bed-5d09-4b3e-95b6-3ad3115714ca
                    stepCounter: 7f3daf64-f84d-4f3f-a86a-19c60b15fffc
                transform: ""
          - columnReference:
              columnCounter: 9790997a-26b3-4804-a1d1-e7baefa3383a
              stepCounter: c5c5283b-7fd6-4bfe-8fad-1733ff926271
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 04b71055-f0d9-4e13-af01-d720549bc709
                    stepCounter: 7f3daf64-f84d-4f3f-a86a-19c60b15fffc
                transform: ""
          - columnReference:
              columnCounter: b2999fb3-23f1-4f86-91d3-7a9d946032c1
              stepCounter: c5c5283b-7fd6-4bfe-8fad-1733ff926271
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMITDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 14c72159-5358-4bd8-8458-6512ea5e32fc
                    stepCounter: 7f3daf64-f84d-4f3f-a86a-19c60b15fffc
                transform: ""
          - columnReference:
              columnCounter: 222a8606-0960-4690-9c5d-ea637665f92d
              stepCounter: c5c5283b-7fd6-4bfe-8fad-1733ff926271
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RECEIPTDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 37e63922-f722-48e6-a49a-589225fd8375
                    stepCounter: 7f3daf64-f84d-4f3f-a86a-19c60b15fffc
                transform: ""
          - columnReference:
              columnCounter: 1975b2b7-6968-49f8-b42d-57d914f47090
              stepCounter: c5c5283b-7fd6-4bfe-8fad-1733ff926271
            dataType: VARCHAR(25)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPINSTRUCT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4dcfa460-612b-4fe2-8908-aefd93a08fce
                    stepCounter: 7f3daf64-f84d-4f3f-a86a-19c60b15fffc
                transform: ""
          - columnReference:
              columnCounter: 522aad20-4cdb-4cc5-a4b8-cd46662586b9
              stepCounter: c5c5283b-7fd6-4bfe-8fad-1733ff926271
            dataType: VARCHAR(10)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPMODE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c16c97e7-0ad8-4cfb-ac83-0d8d1f2cb27f
                    stepCounter: 7f3daf64-f84d-4f3f-a86a-19c60b15fffc
                transform: ""
          - columnReference:
              columnCounter: 64a1e815-6292-4caf-ba1b-4091251ad5ca
              stepCounter: c5c5283b-7fd6-4bfe-8fad-1733ff926271
            dataType: VARCHAR(44)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 7be18bc1-7b5d-4fde-a8a5-e8abd0cb6e22
                    stepCounter: 7f3daf64-f84d-4f3f-a86a-19c60b15fffc
                transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 3c1af970-0f5c-4041-a7aa-896ac93db99c
              stepCounter: c5c5283b-7fd6-4bfe-8fad-1733ff926271
            config: {}
            dataType: NUMBER
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: DAYS_TO_SHIP
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: DATEDIFF('DAY',"STG_ORDERS"."O_ORDERDATE","STG_LINEITEM"."L_SHIPDATE")
            systemColumnType: None
            transform: ""
          - columnReference:
              columnCounter: 0e5ce69d-5322-4cca-8c58-f72da6bf45f1
              stepCounter: c5c5283b-7fd6-4bfe-8fad-1733ff926271
            dataType: NUMBER(38,0)
            description: ""
            name: PS_AVAILQTY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ad576fea-c8b3-416d-a0ba-a82a1b2347c4
                    stepCounter: 5c7a5d6c-f2bc-4ca4-9bc1-1091fe823911
                transform: ""
          - columnReference:
              columnCounter: af99e28c-1734-490b-95bd-f80ede45d430
              stepCounter: c5c5283b-7fd6-4bfe-8fad-1733ff926271
            dataType: NUMBER(12,2)
            description: ""
            name: PS_SUPPLYCOST
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4e2ab77a-4290-42c4-b9e3-69bbaa98556a
                    stepCounter: 5c7a5d6c-f2bc-4ca4-9bc1-1091fe823911
                transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              STG_LINEITEM: 7f3daf64-f84d-4f3f-a86a-19c60b15fffc
              STG_ORDERS: 252c6629-cc41-424d-b143-6fd2d53d8237
              STG_PARTSUPP: 5c7a5d6c-f2bc-4ca4-9bc1-1091fe823911
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: WORK
                nodeName: STG_LINEITEM
              - locationName: WORK
                nodeName: STG_ORDERS
              - locationName: WORK
                nodeName: STG_PARTSUPP
            join:
              joinCondition: |-
                FROM {{ ref('WORK', 'STG_ORDERS') }} "STG_ORDERS"
                
                INNER JOIN {{ ref('WORK', 'STG_LINEITEM') }} "STG_LINEITEM"
                
                ON "STG_ORDERS"."O_ORDERKEY" = "STG_LINEITEM"."L_ORDERKEY"
                
                INNER JOIN {{ ref('WORK', 'STG_PARTSUPP') }} "STG_PARTSUPP"
                
                ON "STG_LINEITEM"."L_PARTKEY" = "STG_PARTSUPP"."PS_PARTKEY" AND "STG_LINEITEM"."L_SUPPKEY" = "STG_PARTSUPP"."PS_SUPPKEY"
            name: STG_ORDERS_LINEITEM
            noLinkRefs: []
      name: STG_ORDERS_LINEITEM
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: c5c5283b-7fd6-4bfe-8fad-1733ff926271
